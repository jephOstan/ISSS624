<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2022-12-15">

<title>ISSS624 - Geographically Weighted Logistic Regression (GWLR)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ISSS624</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-references--notes" role="button" data-bs-toggle="dropdown" aria-expanded="false">References &amp; Notes</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-references--notes">    
        <li>
    <a class="dropdown-item" href="../personal_note/Acronym_Terminology.html">
 <span class="dropdown-text">Acronym &amp; Terminology</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../personal_note/Personal_notes.html">
 <span class="dropdown-text">Common Errors and Basic Concepts</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../personal_note/SpatialAutocorrelationSpatialDependency.html">
 <span class="dropdown-text">Spatial Autocorrelation &amp; Spatial Dependency</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../personal_note/SpatialConstrainedClusterAnalysis.html">
 <span class="dropdown-text">Spatially Constrained Cluster Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../personal_note/gwlr.html">
 <span class="dropdown-text">Geographically Weighted Logistic Regres</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">Hands-on Exercises</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex1-1.html">
 <span class="dropdown-text">Geospatial Data Wrangling with R [1]</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_EX1-2.html">
 <span class="dropdown-text">Choropleth Mapping with R [2]</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex2-4.html">
 <span class="dropdown-text">Global &amp; Local Measures of Spatial Autocorrelation [4]</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex3-5.html">
 <span class="dropdown-text">Spatially Constrained Clustering Techniques [5]</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex4-6.html">
 <span class="dropdown-text">Geographically Weighted Regression [6]</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">In-class Exercises</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="../in-class_ex/in-class_ex1/In-class_Ex1.html">
 <span class="dropdown-text">Spatial Weights &amp; Applications [3]</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../in-class_ex/in-class_ex2/In-class_Ex2.html">
 <span class="dropdown-text">In-class Exercise 2 - Case Study 1.1 Spatial Autocorrelation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../in-class_ex/in-class_ex3/In-class_Ex3.html">
 <span class="dropdown-text">In-class Exercise 3 - Case Study 1.2 Clustering Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../in-class_ex/in-class_ex4/In-class_Ex4.html">
 <span class="dropdown-text">In-class Exercise 4 - Case Study 2.1 Geographically Weighted Regression</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-class-projects" role="button" data-bs-toggle="dropdown" aria-expanded="false">Class Projects</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-class-projects">    
        <li>
    <a class="dropdown-item" href="../class_project/project_1/spatial_weights.html">
 <span class="dropdown-text">Spatial Weights &amp; Applications [1]</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../class_project/project_2/Regionalisation_scca.html">
 <span class="dropdown-text">Regionalisation with Spatially Constrained Cluster Analysis [2]</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html">About</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#suitability-of-linear-regression" id="toc-suitability-of-linear-regression" class="nav-link active" data-scroll-target="#suitability-of-linear-regression">Suitability of Linear Regression</a></li>
  <li><a href="#definition-of-odds" id="toc-definition-of-odds" class="nav-link" data-scroll-target="#definition-of-odds">Definition of Odds</a></li>
  <li><a href="#interpretation-of-a-simple-logistic-regression" id="toc-interpretation-of-a-simple-logistic-regression" class="nav-link" data-scroll-target="#interpretation-of-a-simple-logistic-regression">Interpretation of a simple logistic regression</a></li>
  <li><a href="#differences-between-multiple-logistic-regression-and-linear-regression" id="toc-differences-between-multiple-logistic-regression-and-linear-regression" class="nav-link" data-scroll-target="#differences-between-multiple-logistic-regression-and-linear-regression">Differences between Multiple Logistic Regression and Linear Regression</a>
  <ul class="collapse">
  <li><a href="#assumptions-of-logistic-regression" id="toc-assumptions-of-logistic-regression" class="nav-link" data-scroll-target="#assumptions-of-logistic-regression"><strong>Assumptions of Logistic Regression</strong></a></li>
  </ul></li>
  <li><a href="#workflow-diagram-logistic-regression-modelling" id="toc-workflow-diagram-logistic-regression-modelling" class="nav-link" data-scroll-target="#workflow-diagram-logistic-regression-modelling">Workflow Diagram :: Logistic Regression Modelling</a>
  <ul class="collapse">
  <li><a href="#univariate-analysis" id="toc-univariate-analysis" class="nav-link" data-scroll-target="#univariate-analysis">Univariate Analysis</a></li>
  <li><a href="#bivariate-analysis" id="toc-bivariate-analysis" class="nav-link" data-scroll-target="#bivariate-analysis">Bivariate Analysis</a></li>
  <li><a href="#model-performance-evaluation" id="toc-model-performance-evaluation" class="nav-link" data-scroll-target="#model-performance-evaluation">Model Performance Evaluation</a></li>
  </ul></li>
  <li><a href="#accuracy-of-predictive-modelling" id="toc-accuracy-of-predictive-modelling" class="nav-link" data-scroll-target="#accuracy-of-predictive-modelling">Accuracy of Predictive Modelling</a>
  <ul class="collapse">
  <li><a href="#contigency-table-error-table-confusion-matrix" id="toc-contigency-table-error-table-confusion-matrix" class="nav-link" data-scroll-target="#contigency-table-error-table-confusion-matrix">Contigency Table / Error Table / Confusion Matrix</a></li>
  <li><a href="#misclassification-rate-classification-table-contingency-table" id="toc-misclassification-rate-classification-table-contingency-table" class="nav-link" data-scroll-target="#misclassification-rate-classification-table-contingency-table">Misclassification Rate :: Classification Table / Contingency Table</a></li>
  <li><a href="#receiver-operating-characteristic-roc-curve" id="toc-receiver-operating-characteristic-roc-curve" class="nav-link" data-scroll-target="#receiver-operating-characteristic-roc-curve">Receiver Operating Characteristic (ROC) Curve</a></li>
  </ul></li>
  <li><a href="#geographically-weighted-multiple-logistic-regression-model" id="toc-geographically-weighted-multiple-logistic-regression-model" class="nav-link" data-scroll-target="#geographically-weighted-multiple-logistic-regression-model">Geographically Weighted Multiple Logistic Regression Model</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Geographically Weighted Logistic Regression (GWLR)</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 15, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Key Focuses
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Understand the differences between <strong>binary</strong> and <strong>continuous</strong> outcomes.</li>
<li>Understand the basic concepts and methods of <strong>logistic regression models</strong>.</li>
<li>Interpret the model and analysis results accurately.</li>
<li>Compare and evaluate predictive models generated using logistic regression.</li>
</ol>
<p><strong>Key Questions :</strong></p>
<ul>
<li><p>How do I tell if my model is good?</p></li>
<li><p>How do I tell if the explanatory variable helping my model?</p></li>
<li><p>How do I tell if my model is providing reasonable prediction?</p></li>
</ul>
</div>
</div>
<p>Logistic regression model can be used as :</p>
<ul>
<li><p>explanatory model</p></li>
<li><p>predictive model</p></li>
</ul>
<div class="callout-caution callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Example 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Whether a customer churns, (y = 1) or not churns (y = 0) after signed up a mobile service contract.</p>
<ul>
<li>probability (p) depends on x.</li>
<li>x is the explanatory variable (either categorical (discrete) or quantitative), such as :
<ul>
<li>account age</li>
<li>current billing amount</li>
<li>average days delinquent</li>
</ul></li>
</ul>
</div>
</div>
</div>
<section id="suitability-of-linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="suitability-of-linear-regression">Suitability of Linear Regression</h2>
<p>When the value of a variable is a binary response, the linear regression assumptions are not valid based on the following :</p>
<ul>
<li><p>the relationship between the independent variable and predictor variable is not linear.</p></li>
<li><p>the error terms are :</p>
<ul>
<li><p>heteroscedastic</p></li>
<li><p>not normally distributed</p></li>
</ul></li>
</ul>
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Violated Linear Regression Assumptions
</div>
</div>
<div class="callout-body-container callout-body">
<p>If proceeding in light of these violations, the results would be :</p>
<ul>
<li><p>the predicted probabilities can be greater than 1 or less than 0.</p></li>
<li><p>the magnitude of the effects of independent variables may be greatly underestimated.</p></li>
</ul>
</div>
</div>
<p>A simple linear regression modelled the mean Î¼ of the response variable y as a linear function of the explanatory variable : ğœ‡ = ğ›½0 + ğ›½1ğ‘¥.</p>
<p>A logistic regression would model the mean of the response variable p in terms of an explanatory variable x.</p>
<ul>
<li><p>BUT, this is not a good model when relating p and x through the equation ğ‘ = ğ›½0 + ğ›½1ğ‘¥.</p></li>
<li><p>As long as ğ›½0 â‰  0, extreme values of x will give values of ğ›½0 + ğ›½1ğ‘¥ that is inconsistent with the fact that 0 â‰¤ p â‰¤ 1.</p></li>
</ul>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Logistic Regression Solution :: Log Odds
</div>
</div>
<div class="callout-body-container callout-body">
<p>Transform the odds to get odds ratio, ğ‘ / 1âˆ’ğ‘</p>
<p>note : logistic regressions work with odds rather than proportions.</p>
</div>
</div>
<ul>
<li><p>Model the log odds as a linear function of the explanatory variable.</p></li>
<li><p>The slope in a logistic regression model = the difference between the log(ODDS) for churn and the log(ODDS) for not churn.</p></li>
<li><p>Logistic distribution constrains the estimated probability between 0 and 1, via :</p>
<p>ğ‘ = 1 / 1+ğ‘’âˆ’(ğ›½0+ğ›½1ğ‘¥)</p>
<ul>
<li><p>ğ›½0 + ğ›½1ğ‘¥ = 0 , then p = .50</p></li>
<li><p>ğ›½0 + ğ›½1ğ‘¥ gets really big, p approaches 1</p></li>
<li><p>ğ›½0 + ğ›½1ğ‘¥ gets really small, p approaches 0</p></li>
</ul></li>
</ul>
</section>
<section id="definition-of-odds" class="level2">
<h2 class="anchored" data-anchor-id="definition-of-odds">Definition of Odds</h2>
<p>Odds are the ratio of the proportions for the two possible outcomes.</p>
<p>Odds(event) = P(event) / 1-P(event)</p>
<div class="callout-caution callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Example 2
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Total customers = 13,196</p>
<p>Churn = 1,091</p>
<p>Sample proportion, p^ = 1,091 / 13,196 = 0.0827</p>
<p>Odds = 0.0827 / 0.9173 = 0.0902</p>
<p><strong>Interpretation</strong> :</p>
<p><span style="color:#d69c3c">The odds that a customer is going to churn as 9 to 100.</span></p>
</div>
</div>
</div>
</section>
<section id="interpretation-of-a-simple-logistic-regression" class="level2">
<h2 class="anchored" data-anchor-id="interpretation-of-a-simple-logistic-regression">Interpretation of a simple logistic regression</h2>
<div class="callout-caution callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Example 3
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>simple logistic regression, ln (ğ‘ƒ / 1 âˆ’ ğ‘) = 0.5954 + âˆ’0.0255(account_age)</p>
<p>For account_age = 20,</p>
<p>ln (ğ‘ƒ / 1 âˆ’ ğ‘ƒ) = 0.5954 + âˆ’0.0255(20) = 0.0854</p>
<p>ğ‘’0.0854 / (1 + ğ‘’0.0854) = 0.5213</p>
<p>note :</p>
<ul>
<li><p>For every 1 month increase in account_age, the logit of the probability of a churn decrease by 0.0255.</p></li>
<li><p>Given account_age of a customer is 20, the log-odds = 0.0854</p></li>
<li><p>Probability of Churn (also known as <strong>probability of log-odds</strong>) = 0.5213</p></li>
</ul>
<p><strong>Interpretation</strong> :</p>
<p><span style="color:#d69c3c">A customer with 20 months account_age has an average of 0.5213 chance that she/he will churn.</span></p>
</div>
</div>
</div>
</section>
<section id="differences-between-multiple-logistic-regression-and-linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="differences-between-multiple-logistic-regression-and-linear-regression">Differences between Multiple Logistic Regression and Linear Regression</h2>
<p>Instead of using a least-squared deviations criterion for the best fit, it uses a maximum likelihood method, which maximizes the probability of getting the observed results given the fitted regression coefficients.</p>
<p>A consequence is that the goodness of fit and overall significance statistics used in logistic regression<br>
differ from those used in linear regression.</p>
<section id="assumptions-of-logistic-regression" class="level3">
<h3 class="anchored" data-anchor-id="assumptions-of-logistic-regression"><strong>Assumptions of Logistic Regression</strong></h3>
<ul>
<li><p>Logistic regression does not assume a linear relationship between the dependent and independent variables.</p></li>
<li><p>For binary logistic regression, the dependent variable must be a dichotomy (2 categories).</p></li>
<li><p>The independent variables need not be interval, normally distributed, linearly related, nor of equal variance within each group.</p></li>
<li><p>The categories (groups) must be mutually exclusive and exhaustive.</p></li>
<li><p>A case can only be in one group and every case must be a member of one of the groups.</p></li>
</ul>
<p>For logistic regression, a larger samples are needed than for linear regression because maximum likelihood coefficients are large sample estimates.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Minimum of 50 cases per predictor is recommended.
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
</section>
</section>
<section id="workflow-diagram-logistic-regression-modelling" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="workflow-diagram-logistic-regression-modelling">Workflow Diagram :: Logistic Regression Modelling</h2>
<p><img src="images/paste-C79E5F44.png" class="img-fluid" width="267"></p>
<section id="univariate-analysis" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="univariate-analysis">Univariate Analysis</h3>
<p>Check for outliers and determine the distribution of each predictor variable.</p>
<p>Determine the numbers of dummy variables to create for a predictor variable.</p>

<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/paste-D9B80475.png" class="img-fluid figure-img" width="196"></p>
<p></p><figcaption class="figure-caption">A margin image</figcaption><p></p>
</figure>
</div>
</div></div><ul>
<li><p>E.g. the figure above shows that when â€œNon-churnâ€ cases are strongly related to â€œMovingâ€ and â€œCheck Accountâ€ under the â€œComplain Codeâ€ variable.</p>
<ul>
<li>Consider combining both â€œMovingâ€ and â€œCheck Accountâ€ to form a group.</li>
</ul></li>
</ul>
</section>
<section id="bivariate-analysis" class="level3">
<h3 class="anchored" data-anchor-id="bivariate-analysis">Bivariate Analysis</h3>
<p>Similar to multiple linear regression, logistic regression model is sensitive to multicollinearity.</p>
<pre><code>-   Multicollinearity occurs when some of the predictors are highly correlated.</code></pre>
</section>
<section id="model-performance-evaluation" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="model-performance-evaluation">Model Performance Evaluation</h3>
<p>There are several statistics which can be used for comparing alternative models or evaluating the performance of a logistic regression model :</p>
<ul>
<li>Whole model test</li>
<li>Fit statistics</li>
<li>Assessing individual parameters</li>
</ul>
<section id="whole-model-test" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="whole-model-test">1. Whole Model Test</h4>
<p>Testing :</p>
<p>ğ»0 : The logistic model is NOT useful ğ»1 : The logistic model is useful</p>

<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/paste-9EB562C2.png" class="img-fluid figure-img" width="290"></p>
<p></p><figcaption class="figure-caption">A margin image</figcaption><p></p>
</figure>
</div>
</div></div><p>The test is analogous to the Analysis of Variance table for continuous responses.</p>
<p>The negative log-likelihood corresponds to the sums of squares, and the Chi-square test corresponds to the F-test.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
<strong>Decision</strong> :
</div>
</div>
<div class="callout-body-container callout-body">
<p><span style="color:#d69c3c"><strong>Reject ğ»0</strong> if the <strong>Chi Square</strong> is large and the <strong>ğ‘ value</strong> is smaller than the <strong>critical value</strong> (i.e.&nbsp;0.05, or 0.01, 0.001, 0.0001).</span></p>
<ul>
<li><p>The ğ‘-value &lt; 0.0001* indicates that the logistic model is useful to explain the ODDS(churn).</p></li>
<li><p>In other words, the overall model is significant at the .0001 level according to the Model chi-square statistic.</p></li>
</ul>
</div>
</div>
</section>
<section id="lack-fof-fit-test-goodness-of-fit" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="lack-fof-fit-test-goodness-of-fit">2. Lack fof Fit Test (Goodness of Fit)</h4>
<p>Testing :</p>
<p>ğ»0 : The model is adequate ğ»1 : The model is inadequate, i.e.&nbsp;there is lack of fit.</p>

<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/paste-CC289BAF.png" class="img-fluid figure-img" width="220"></p>
<p></p><figcaption class="figure-caption">A margin image</figcaption><p></p>
</figure>
</div>
</div></div><div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
<strong>Decision</strong> :
</div>
</div>
<div class="callout-body-container callout-body">
<p><span style="color:#d69c3c"><strong>Reject ğ»0</strong> if the <strong>Chi Square statistics</strong> is large and the <strong>ğ‘ value</strong> is smaller than the <strong>critical value</strong> (i.e.&nbsp;0.05, or 0.01, 0.001, 0.0001).</span></p>
<p>The above figure shows that the Lack of Fit Chi-square is not significant (Prob &gt; ChiSq = 0.4223) and supports the conclusion that there is little to be gained by introducing additional variables.</p>
</div>
</div>
</section>
<section id="assessing-individual-parameters" class="level4">
<h4 class="anchored" data-anchor-id="assessing-individual-parameters">3. Assessing Individual Parameters</h4>
<p>Testing :</p>
<p>ğ»0 : ğ›½1 = 0</p>
<p>ğ»1 : ğ›½1 â‰  0</p>
<p>Test statistics, ğ‘ = ğ‘1 / ğ‘†ğ¸<sub>ğ‘1</sub></p>
<ul>
<li><p>Statistical inference for multiple logistic regression is similar to statistical inference for multiple linear regression.</p></li>
<li><p>Calculate estimates of the model parameters and standard errors for these estimates.</p></li>
<li><p>Confidence intervals are formed in the usual way but use standard normal zâˆ—-values rather than critical values from the t distributions.</p></li>
<li><p>The ratio of the estimate to the standard error is the basis for hypothesis tests.</p></li>
<li><p>Often the test statistics are given as the squares of these ratios.</p>
<ul>
<li><p>In this case, the P-values are obtained from the chi-square distributions with 1 degree of freedom.</p></li>
<li><p>The statistic z is sometimes called a <strong>Wald statistic</strong>.</p></li>
</ul></li>
</ul>
<p><img src="images/paste-3A5DD912.png" class="img-fluid" width="346"></p>
<p>Output from some statistical software reports the significance test results in terms of chi-square statistic, i.e.&nbsp;square of the z statistic</p>
<p>ğ‘‹<sup>2</sup> = ğ‘¥<sup>2</sup></p>
<ul>
<li><p>When the null hypothesis is true, it has a distribution that is approximately a ğ‘¥<sup>2</sup> distribution with 1 degree of freedom, and the P-value is calculated as P(ğ‘¥<sup>2</sup> â‰¥ ğ‘‹<sup>2</sup>).</p></li>
<li><p>Because the square of a standard normal random variable has a ğ‘¥<sup>2</sup> distribution with 1 degree of freedom, the ğ‘§ statistic and the chi-square statistic give the same results for statistical inference.</p>
<ul>
<li><p>The Parameter Estimates report reveals that not all predictor variables are significant.</p></li>
<li><p>In fact, only Avg Days Delinquent and Account Age with p-values &lt; 0.0001.</p></li>
<li><p>The Condition of Current Handset is not significant.</p></li>
</ul></li>
</ul>
</section>
<section id="likelihood-ratio-test-lrt" class="level4">
<h4 class="anchored" data-anchor-id="likelihood-ratio-test-lrt">Likelihood-ratio Test (LRT)</h4>
<p>LRT tests are computed iteratively and can be computationally intensive for some models, so historically Waldâ€™s tests had been used more often.</p>
<p>The Effect Likelihood Ratio Tests report above show that both predictor variables Avg Days Delinquent and Account Age are significant at p &lt; 0.0001 and predictor Condition of Current Handset is not significant p = 0.3181.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
<strong>Note :</strong> LRT are more reliable than Waldâ€™s tests, so use LRT when possible.
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
</section>
</section>
</section>
<section id="accuracy-of-predictive-modelling" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="accuracy-of-predictive-modelling">Accuracy of Predictive Modelling</h2>
<section id="contigency-table-error-table-confusion-matrix" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="contigency-table-error-table-confusion-matrix">Contigency Table / Error Table / Confusion Matrix</h3>
<p>In binomial logistic regression, the classification table is a 2 x 2 table that contains the observed and predicted model results.</p>

<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/paste-79FA28F6.png" class="img-fluid figure-img" width="232"></p>
<p></p><figcaption class="figure-caption">A margin image</figcaption><p></p>
</figure>
</div>
</div></div><p>The contingency table has 4 data cells :</p>
<ol type="1">
<li><p><strong>Actual 0 Predicted 0</strong> â€“ The number of cases that were both predicted and observed as 0.</p>
<ul>
<li><p>The records in this cell are referred to as true negatives.</p></li>
<li><p>The model classification was correct for these records.</p></li>
</ul></li>
<li><p><strong>Actual 0 Predicted 1</strong> â€“ The number of cases that were predicted as 1 yet observed as 0.</p>
<ul>
<li><p>The records in this cell are referred to as false positives.</p></li>
<li><p>The model classification was incorrect for these records.</p></li>
</ul></li>
<li><p><strong>Actual 1 Predicted 1</strong> â€“ The number of cases that were both predicted and observed as 1.</p>
<ul>
<li><p>The records in this cell are referred to as true positives.</p></li>
<li><p>The model classification was correct for these records.</p></li>
</ul></li>
<li><p><strong>Actual 1 Predicted 0</strong> â€“ The number of cases that were predicted as 0 yet observed as 1.</p>
<ul>
<li><p>The records in this cell are referred to as false negatives.</p></li>
<li><p>The model classification was incorrect for these records.</p></li>
</ul></li>
</ol>
<p>The model classify each data record based on :</p>
<ul>
<li><p>The computed probability between 0 and 1.</p></li>
<li><p>The threshold / cut value = the minimal value of probability to classify as 0 or 1.</p>
<ul>
<li>The default â€œcut valueâ€ is 0.5. When a value is larger than 0.5, will be classified as 1.</li>
</ul></li>
</ul>
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Different fields of applications has different tolerable rates of false positives and false negatives.
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
</section>
<section id="misclassification-rate-classification-table-contingency-table" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="misclassification-rate-classification-table-contingency-table">Misclassification Rate :: Classification Table / Contingency Table</h3>
<p>To assess the overall performance of a logistic regression model.</p>

<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/paste-E60C7E5C.png" class="img-fluid figure-img" width="296"></p>
<p></p><figcaption class="figure-caption">A margin image</figcaption><p></p>
</figure>
</div>
</div></div><ul>
<li><p>The classification table above shows that there are 346 false negative and 275 false positive. The <strong>overall misclassification error</strong> is 22.06%, i.e.&nbsp;( 346 + 275 ) / 2815 ).</p></li>
<li><p>According to the Misclassification Rate measure, the model predicts 77.94% of the churn cases correctly.</p></li>
</ul>
<p>Contingency Analysis</p>
<p>Overall Accuracy ::: callout-tips overall_accuracy = ( ğ‘»ğ‘· + ğ‘»ğ‘µ ) / ( ğ‘»ğ‘· + ğ‘­ğ‘· + ğ‘­ğ‘µ + ğ‘»ğ‘µ ) ::: Refers to the correctly classified observations divided by the total number of observations. - This statistics is not a particularly useful measure because it gives equal weight to all components.</p>
<p>Sensitivity refers to the true positive rate. ::: callout-tips sensitivty = ( ğ‘»ğ‘· ) / ( ğ‘»ğ‘· + ğ‘­ğ‘µ ) :::</p>
<p>Specificity refers to the true negative rate. ::: callout-tips specificity = ( ğ‘»ğ‘µ ) / ( ğ‘»ğ‘µ + ğ‘­ğ‘· ) :::</p>
<p>False Positive rate indicates the probability of predicted non-negative event. ::: callout-tips false positive = ( ğ‘­ğ‘· ) / ( ğ‘»ğ‘µ + ğ‘­ğ‘·)</p>
</section>
<section id="receiver-operating-characteristic-roc-curve" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="receiver-operating-characteristic-roc-curve">Receiver Operating Characteristic (ROC) Curve</h3>

<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/paste-6CE1863E.png" class="img-fluid figure-img" width="174"></p>
<p></p><figcaption class="figure-caption">A margin image</figcaption><p></p>
</figure>
</div>
</div></div><p>An ROC curve shows how rapidly the true positive and false negative transition happens, with the goal being to have diagnostics that maximize the area under the curve.</p>
<p>Two standard definitions used in predictive modelling are as follows : â€¢ Sensitivity = the probability that a given x value (a test or measure) correctly predicts an existing condition.</p>
<p>â€¢ Specificity, the probability that a test correctly predicts that a condition does not exist.</p>
<p>A ROC curve is a plot of sensitivity by (1 â€“ specificity) for each value of x. The area under the ROC curve is a common index used to summarize the information contained in the curve.</p>
<p>In the plot, a light yellow line is drawn at a 45 degree angle tangent to the ROC Curve. This marks a good cutoff point under the assumption that false negatives and false positives have similar costs.</p>
<p>ROC Gives a good indication to model performance (values are between 0.5 and 1).</p>
<p>This variable should be as high as possible with some restrictions. Typical values indicate the following: â€¢ 0.5 â€“ No distinguish ability (the model has no meaning). â€¢ 0.51 â€“ 0.7 â€“ Low distinguish ability (not a very good model yet the model can be used). â€¢ 0.71 â€“ 0.9 â€“ Very good distinguish ability. â€¢ 0.91 â€“ 1 â€“ Excellent distinguish ability.</p>
<p>Warning: In some fields, logistic regression models can have an excellent distinguish ability, however this might indicate that the model is â€œtoo good to be trueâ€. Double and triple check your model making sure that no variables from the future are present and that the model has no other odd parameter values.</p>
</section>
</section>
<section id="geographically-weighted-multiple-logistic-regression-model" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="geographically-weighted-multiple-logistic-regression-model">Geographically Weighted Multiple Logistic Regression Model</h2>
<p>As an expansion to the standard logistic regression, logistic GWR incorporates a set geographical location to the models :</p>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
logit ( p<sub>i</sub> ) = log ( p<sub>i</sub> / 1 - p<sub>i</sub> ) = ğ›½<sub>0</sub>( u<sub>i</sub> , v<sub>i</sub> ) + ğ›½<sub>1</sub>( u<sub>i</sub> , v<sub>i</sub> )ğ‘¥<sub>1</sub>
</div>
</div>
<div class="callout-body-container callout-body">
<p>where, ğ›½<sub>0i</sub> and ğ›½<sub>1i</sub> = local model parameters specific to location at ( u<sub>i</sub> , v<sub>i</sub> ) coordinate.</p>
</div>
</div>
<p>GWLR is the geographically weighted extension to the logistic regression model and similar to ordinary regression. But with the help of a moving window or kernel function facility provided by geographically weighted methods, local regression models are computed at locations all over the study region.</p>
<p>The GWR discussed in previous lesson can be extended to GWLR with the help of a logit function as shown in the formula above.</p>
<p>The distance weights of GWLR are distance-based.</p>
<p>Two commonly used distance weights :</p>
<ul>
<li><p>fixed-distance weighted</p></li>
<li><p>adaptive-distance weighted</p></li>
</ul>
<p>The minimum bandwidth distance or size can be determined by :</p>
<ul>
<li><p>Akaike Information criterion (AIC)</p></li>
<li><p>Cross-validation (CV)</p></li>
</ul>
<div class="page-columns page-full"><p>Similar to basic gwr method, five (5) spatial kernel<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> namely :</p><div class="no-row-height column-margin column-container"><li id="fn1"><p><sup>1</sup>&nbsp;Exploratory Spatial Data Analysis with gwpcorMapper: an Interactive Mapping Tool for Geographically Weighted Correlation and Partial Correlation - Scientific Figure on ResearchGate. Available from: https://www.researchgate.net/figure/Kernel-functions-available-in-gwpcorMapper-a-Gaussian-b-exponential-c-box-car-d_fig2_360992908 [accessed 15 Dec, 2022]</p></li></div></div>
<ul>
<li><p>Gaussian,</p></li>
<li><p>Exponential,</p></li>
<li><p>Box-car,</p></li>
<li><p>Bi-square</p></li>
<li><p>Tri-cube smoothing methods</p></li>
</ul>
<p>References - Method â€¢ Kleinbaum, D.G. and Klein, M (2010) Logistic Regression: A Selfâ€Learning Text (3rd Edition). Springer New York. â€¢ Hosmer, D. W., JR. et. al (2013) Applied Logistic Regression (3rd Edition). John Wiley &amp; Sons, Inc., Hoboken, New Jersey. â€¢ Atkinson PM, German SE, Sear DQ and Clark MJ (2003) â€œExploring the relations between riverbank erosion and geomorphological controls using geographically weighted logistic regressionâ€. Geographical Analysis 35(1): 58â€“82.</p>


</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>