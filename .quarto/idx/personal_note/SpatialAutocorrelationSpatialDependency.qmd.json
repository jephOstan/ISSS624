{"title":"Spatial Autocorrelation & Spatial Dependency","markdown":{"yaml":{"title":"Spatial Autocorrelation & Spatial Dependency","editor":"visual","date":"24 Nov 2022"},"headingText":"PERSONAL NOTES","containsRefs":false,"markdown":"\n\n\n# SPATIAL RELATIONSHIPS\n\n### **Spatial Relationships Types**\n\nAdjacency, contiguity, overlap, and proximity are the four ways of describing the relationship between two or more entities.\n\nSpacial relationship either -\n\n-   **variable values** for themes defined space - rainfall.\n\n-   **locations** for themes defined objects - cities.\n\n-   \\>\\> measured as the existence of statistical dependence in a collection of random variables, each of which is associated with a different geographical location\n\n# **SPATIAL DEPENDENCY**\n\nTools for exploring spatial dependence include :\n\n-   [spatial correlation](https://en.wikipedia.org/wiki/Spatial_correlation \"Spatial correlation\"), (?)\n\n-   [spatial covariance functions](https://en.wikipedia.org/wiki/Spatial_covariance_function \"Spatial covariance function\") (?)\n\n-   [semivariograms](https://en.wikipedia.org/wiki/Semivariogram \"Semivariogram\") (?)\n\nMethods for spatial interpolation include [Kriging](https://en.wikipedia.org/wiki/Kriging \"Kriging\"), which is a type of [best linear unbiased prediction](https://en.wikipedia.org/wiki/Best_linear_unbiased_prediction \"Best linear unbiased prediction\"). (?)\n\n<br>\n\n# **SPATIAL AUTOCORRELATION**\n\nSpatial dependency is the co-variation of properties within geographic space : characteristics at proximal locations appear to be correlated, either positively or negatively.\n\nSpatial dependency leads to the **spatial [autocorrelation](https://en.wikipedia.org/wiki/Autocorrelation \"Autocorrelation\")** problem in statistics as it violates standard statistical techniques that assume independence among observations.\n\nSpatial autocorrelation measures and analyse the degree of dependency among observations in a geographic space.\n\n-   Spatial autocorrelation statistics are global in the sense that they estimate the overall degree of spatial autocorrelation for a dataset. The possibility of spatial heterogeneity suggests that the estimated degree of autocorrelation may vary significantly across geographic space.\n\n-   **Local spatial autocorrelation statistics** provide estimates disaggregated to the level of the spatial analysis units, allowing assessment of the dependency relationships across space.\n\n## VARIABLE VALUES ASSUMPTION\n\nThe variable can assume values either :\n\n-   At **any point** on a **continuous surface** (e.g. land use type or annual precipitation levels in a region);\n\n-   At a **set of fixed sites** located within a region (e.g. prices at a set of retail outlets);\n\n-   Across a set of areas that subdivide a region (e.g. the count or proportion of households with two or more cars in a set of Census tracts that divide an urban region).\n\n<br>\n\n### interpret spatial distribution\n\n-   clustering spatial distribution = high spatial autocorrelation\n\n-   checkerboard spatial distribution = low spatial autocorrelation\n\n| trait                 | Positive Spatial Autocorrelation                                  | Negative Spatial Autocorrelation                          |\n|----------------|------------------------------|--------------------------|\n| clustering            | similar values tend to be in similar locations, cluster pattern   | dispersed, regular pattern (\\*\\* != random pattern)       |\n| neighbours similarity | high similarity than under spatial randomness.                    | low similarity than under spatial randomness.             |\n| compatibility         | compatible with diffusion, but not necessary caused by diffusion. | compatible to competition, but not necessary competition. |\n| visual ref            | ![](images/paste-C64372AD.png)                                    | ![](images/paste-0D24D306.png)                            |\n\n: Table 1 : Summary of spatial autocorrelation relationship.\n\n<br>\n\n## GLOBAL SPATIAL AUTOCORRELATION (GSA) MEASUREMENT\n\n-   **Moran's I** = describe how features differ from the values in the study area **as a whole**.\n\n-   **Geary's C** = describe how features differ from their **immediate neighbours**.\n\nRelationship of Moran's I & Geary's C :\n\n-   C approaches 0 and I approaches 1 when similar values are **clustered**.\n\n-   C approaches 3 and I approaches -1 when dissimilar values **tend to cluster**.\n\n-   High values of C measures correspond to low values of I = **both measures are\\\n    inversely related**.\n\n-   I is a measure of global spatial autocorrelation, while C is more sensitive to local spatial autocorrelation.\n\n### **Moran's I**\n\nMoran I (Z value) is :\n\n-   positive (I\\>0): Clustered, observations tend to be similar;\n\n-   negative(I\\<0): Dispersed, observations tend to be dissimilar;\n\n-   approximately zero: observations are arranged randomly over space\n\n### Geary's C\n\nGeary C (Z value) is :\n\n-   Large c value (\\>1) : Dispersed, observations tend to be dissimilar;\n\n-   Small c value (\\<1) : Clustered, observations tend to be similar;\n\n-   c = 1: observations are arranged randomly over space.\n\n### **Getis-Ord Global G**\n\nMeasures of global high / low clustering.\n\n-   Concerned with the overall concentration or lack of concentration in all pairs that are neighbours given the definition of neighbouring areas.\n\n-   The variable MUST contain only positive values to be used.\n\n    \\>\\> e.g. growth rate that consists +ve & -ve. The value will be off if involve -ve value.\n\n| interpretation | cannot reject H0                                                                                              | may reject H0                                                                                                                                                | may reject H0                                                                                                                                               |\n|---------------|:--------------|:---------------------|:---------------------|\n| p-value        | not significant                                                                                               | statistically significant                                                                                                                                    | statistically significant                                                                                                                                   |\n| z-score        | \\-                                                                                                            | positive                                                                                                                                                     | negative                                                                                                                                                    |\n| remarks        | Observed spatial pattern of values could be one of many possible versions of **complete spatial randomness**. | **Spatial distribution of high values** in the dataset is more spatially clustered than would be expected if underlying spatial processes were truly random. | **Spatial distribution of low values** in the dataset is more spatially clustered than would be expected if underlying spatial processes were truly random. |\n\n<br>\n\n\\*\\* revision corner \\*\\*\n\n![](images/paste-35408948.png){width=\"368\"}\n\n-   select confident interval 95% =\\> alpha value = 0.05\n\n-   reject Null hypothesis (H0) if p-value \\< alpha value\n\n-   failed to reject H0 if p-value \\> alpha value\n\n<br>\n\n## LOCAL SPATIAL AUTOCORRELATION\n\n-   A collection of geospatial statistical analysis methods for analysing the location related tendency (clusters or outliers) in the attributes of geographically referenced data (points or areas).\n\n-   Can be indecies decomposited from their global measures such as local Moran's I, local Geary's c, and Getis-Ord Gi\\*.\n\n-   These spatial statistics are well suited for :\n\n    -   detecting clusters or outliers;\n\n    -   identifying hot spot or cold spot areas;\n\n    -   assessing the assumptions of stationarity;\n\n    -   identifying distances beyond which no discernible association obtains.\n\n### local indicator of spatial association (LISA)\n\nA subset of localised geospatial statistics methods.\n\nAny spatial statistics that satisfies the following two requirements :\n\n-   the LISA for **each observation gives an indication of the extent of significant spatial clustering** of similar values around that observation;\n\n-   the sum of LISAs for **all observations is proportional to a global indicator** of spatial association.\n\nLocal Indicators of Spatial Association or LISA are statistics that evaluate the existence of clusters in the spatial arrangement of a given variable.\n\nFor instance if we are studying cancer rates among census tracts in a given city local clusters in the rates mean that there are areas that have higher or lower rates than is to be expected by chance alone; that is, the values occurring are above or below those of a random distribution in space.\n\n### interpret Local Moran & scatterplot\n\nAn **outlier** = **significant & negative** if location i is associated with relatively low values in surrounding locations.\n\nA **cluster** = **significant & positive** if location i is associated with relatively high values of the surrounding locations.\n\n-   In either instance, the p-value for the feature must be small enough for the cluster or outlier to be considered statistically significant.\n\n-   The commonly used alpha-values are 0.1, 0.05, 0.01, 0.001 corresponding the 90%, 95, 99% and 99.9% confidence intervals respectively.\n\n### \n\n### detect hot & cold spot areas with Getis-Ord Gi statistic\n\nInterpretation of Getis-Ord Gi and Gi :\n\n-   A **hot spot** area: **significant and positive** if location i is associated with relatively **high values** of the surrounding locations.\n\n-   A **cold spot** area: **significant and negative** if location i is associated with relatively **low values** in surrounding locations.\n\n<br>\n\n## **SPATIAL RANDOMNESS**\n\n### Null hypothesis (H0)\n\n-   Observed spatial pattern of values is **equally likely** as any other spatial pattern.\n\n-   Values at one location **do not depend** on values at other (neighbouring) locations.\n\n-   Under spatial randomness, the **location of values** **may be altered without affecting**\\\n    the **information content** of the data.\n\n### \n\n### assess the violation of assumptions\n\nUse a **Monte Carlo simulation** to assess the assumptions of Moran's I are true (normality and randomisation).\n\n-   Simulate Moran's I n times under the assumption of no spatial pattern,\n\n-   Assigning all regions the mean value\n\n-   Calculate Moran's I,\n\n-   Compare actual value of Moran's I to randomly simulated distribution to obtain p-value (pseudo significance).\n\n<br>\n\n## CONSIDERATIONS FOR WEIGHTING SCHEME\n\n### fixed weighting scheme\n\n-   All features should have at least one neighbour.\n\n-   No feature should have all other features as neighbours.\n\n-   Especially when input field values are skewed, focus on features to have about eight neighbors each.\n\n-   Might produce large estimate variances where data are sparse, while mask subtle local variations where data are dense.\n\n-   In extreme condition, fixed schemes might not be able to calibrate in local areas where data are too sparse to satisfy the calibration requirements (observations must be more than parameters).\\\n\n### adaptive weighting scheme\n\n-   Adaptive schemes adjust itself according to the density of data\n\n-   Shorter bandwidths where data are dense and longer where sparse.\n\n-   Finding nearest neighbors are one of the oen used approaches.\n\n<br>\n\n## SUITABILITY OF SPATIAL WEIGHTING METHOD\n\n### **polygon contiguity method**\n\n-   Effective when polygons are similar in size and distribution, and\n\n-   When spatial relationships are a function of polygon proximity (if two polygons share a boundary, spatial interaction between them increases).\n\n-   When select a polygon contiguity conceptualization - select row standardization for tools that have the Row Standardization parameter.\\\n\n### **fixed distance method**\n\n-   Works well for point data. It is often a good option for polygon data.\n\n-   When there is a **large variation in polygon size** (very large polygons at the edge of the study area and **very small polygons at the center** of the study area.\n\n-   Ensure a consistent scale of analysis.\n\n### \n\n### inverse distance method\n\n-   Most appropriate with continuous data or to model processes where the closer two features are in space, the more likely they are to interact / influence each other.\n\n-   Every feature is potentially a neighbour of every other feature, and with large datasets, the number of computations involved will be enormous.\n\n### k-nearest neighbours method\n\nEffective when you want to ensure you have a minimum number of neighbors for your analysis.\n\nWorks well when the data distribution varies across the study area so that some features are far away from all other features.\n\n-   Especially when the associated features values are skewed (are not normally distributed), it is important that each feature is evaluated within the context of at least eight or so neighbors (this is a rule of thumb only).\n\n-   Spatial context of the analysis changes depending on variations in the sparsity/density of the features.\n\n-   When fixing the scale of analysis is less important than fixing the number of neighbors, the k-nearest neighbours method is appropriate.\n\n<br>\n\n## GUIDE TO SELECT FIXED-DISTANCE BAND VALUE\n\n-   Select a distance based on what you know about the geographic extent of the spatial processes promoting clustering for the phenomena you are studying.\n\n-   Use a distance band that is large enough to ensure all features will have at least one neighbor, or results will not be valid.\n\n-   Try not to get stuck on the idea that there is only one correct distance band.\n\n-   Most likely, there are multiple/interacting spatial processes\\\n    promoting observed clustering.\n\n-   Select an appropriate distance band or threshold distance.\n\n-   All features should have at least one neighbour.\n\n-   No feature should have all other features as a neighbour.\n\n-   Especially if the values for the input field are skewed, each feature should have about eight neighbours.\n\n\\\n\n\\\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":true,"output-file":"SpatialAutocorrelationSpatialDependency.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.269","editor":"visual","theme":"sandstone","title":"Spatial Autocorrelation & Spatial Dependency","date":"24 Nov 2022"},"extensions":{"book":{"multiFile":true}}}}}